<UserControl x:Class="teste_tecnico.Views.PessoasView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:teste_tecnico.Views"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="800">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Filtros de Pessoa -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
            <TextBlock Text="Nome:" VerticalAlignment="Center" Margin="5"/>
            <TextBox Text="{Binding FiltroNome, UpdateSourceTrigger=PropertyChanged}" Width="150" Margin="5"/>
            <TextBlock Text="CPF:" VerticalAlignment="Center" Margin="5"/>
            <TextBox Text="{Binding FiltroCpf, UpdateSourceTrigger=PropertyChanged}" Width="120" Margin="5"/>
        </StackPanel>

        <!-- Grid de Pessoas -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <DataGrid Grid.Column="0" ItemsSource="{Binding PessoasView}" 
                      SelectedItem="{Binding SelectedPessoa}"
                      AutoGenerateColumns="False" CanUserAddRows="False" IsSynchronizedWithCurrentItem="True">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="ID" Binding="{Binding Id}" IsReadOnly="True"/>
                    <DataGridTextColumn Header="Nome" Binding="{Binding Nome, UpdateSourceTrigger=PropertyChanged}"/>
                    <DataGridTextColumn Header="CPF" Binding="{Binding CPF, UpdateSourceTrigger=PropertyChanged}"/>
                    <DataGridTextColumn Header="Endereço" Binding="{Binding Endereco, UpdateSourceTrigger=PropertyChanged}" Width="*"/>
                </DataGrid.Columns>
            </DataGrid>
            <StackPanel Grid.Column="1" Margin="10,0,0,0">
                <Button Content="Incluir" Command="{Binding AddCommand}" Margin="5"/>
                <Button Content="Salvar" Command="{Binding SaveCommand}" Margin="5"/>
                <Button Content="Excluir" Command="{Binding DeleteCommand}" Margin="5"/>
            </StackPanel>
        </Grid>
        
        <!-- Filtros de Pedido -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,0,0">
            <TextBlock Text="Filtrar pedidos por status:" FontWeight="Bold" VerticalAlignment="Center" Margin="5"/>
            <CheckBox Content="Pendentes" IsChecked="{Binding MostrarPendentes}" VerticalAlignment="Center" Margin="5"/>
            <CheckBox Content="Pagos" IsChecked="{Binding MostrarPagos}" VerticalAlignment="Center" Margin="5"/>
            <CheckBox Content="Entregues" IsChecked="{Binding MostrarEntregues}" VerticalAlignment="Center" Margin="5"/>
        </StackPanel>

        <GroupBox Header="Pedidos do Cliente Selecionado" Grid.Row="3" Margin="0,5,0,0">
            <DataGrid ItemsSource="{Binding PedidosDaPessoaView}" AutoGenerateColumns="False" IsReadOnly="True" ColumnWidth="*">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Data da Venda" Binding="{Binding DataVenda, StringFormat='dd/MM/yyyy HH:mm'}"/>
                    <DataGridTextColumn Header="Valor Total" Binding="{Binding ValorTotal, StringFormat=C2}"/>
                    <DataGridTextColumn Header="Forma de Pagamento" Binding="{Binding FormaPagamento}"/>
                    <DataGridTextColumn Header="Status" Binding="{Binding Status}"/>
                    <DataGridTemplateColumn Header="Ações">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <Button Content="Pago" 
                                            Command="{Binding DataContext.MarcarComoPagoCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                            CommandParameter="{Binding}" Margin="2"/>
                                    <Button Content="Enviado" 
                                            Command="{Binding DataContext.MarcarComoEnviadoCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                            CommandParameter="{Binding}" Margin="2"/>
                                    <Button Content="Recebido" 
                                            Command="{Binding DataContext.MarcarComoRecebidoCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                            CommandParameter="{Binding}" Margin="2"/>
                                </StackPanel>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </GroupBox>
    </Grid>
</UserControl>
